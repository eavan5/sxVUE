{"version":3,"file":"vue.js","sources":["../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/util.js","../src/state.js","../src/init.js","../src/vdom/index.js","../src/index.js"],"sourcesContent":["// 编写的代码  <div id='app' style=\"color:red\"> hello {{name}} <span>hello</span></div>\n// 逾期结果: render(){\n//   return _c('div',{id:'app',style:{color:'red'}},_v('hello'+_s(name)),_c('span',null,_v(\"hello\")))\n// }\n\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g  //匹配html里面的模板的\n\n// 语法层面的转译\nfunction genProps(attrs) {\n  let str = ''\n  for (let i = 0; i < attrs.length; i++) {\n    const attr = attrs[i];\n    if (attr.name === 'style') {\n      let obj = {} //对样式进行特殊处理\n      attr.value.split(',').forEach(item => {\n        let [key, value] = item.split(\":\")\n        obj[key] = value\n        attr.value = obj\n      })\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\n\n\n  }\n  return `{${str.slice(0, -1)}}`\n}\n\nfunction gen(node) {\n  if (node.type === 1) { //生成元素节点的字符串\n    return generate(node)\n  } else {\n    let text = node.text\n    // 如果是普通文本 (不带{{}}的)\n\n    if (!defaultTagRE.test(text)) {\n      return `_v(${JSON.stringify(text)})`  // _v(\"hello{{name}}\") => _v('hello'+_v(name))\n    }\n    // 如果是<div>hello{{aaa}} world {{bbb}}</div>\n    let tokens = []  //存放 每一段代码\n    let lastIndex = defaultTagRE.lastIndex = 0 //如果正则是全局模式 需要每次使用前 置为零\n    let match, index  //每次匹配到的结果\n    while (match = defaultTagRE.exec(text)) {\n      index = match.index //保存匹配到的索引\n      if (index > lastIndex) {\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n      }\n      tokens.push(`_s(${match[1].trim()})`)\n      lastIndex = index + match[0].length\n    }\n    if (lastIndex < text.length) {\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\n    }\n    return `_v(${tokens.join('+')})`\n  }\n}\n\n\nfunction getChildren(el) {\n  const children = el.children\n  if (children) { // 将所有转换后的儿子用逗号拼接起来\n    return children.map(child => gen(child)).join(',')\n  }\n}\n\nexport function generate(el) {\n  let children = getChildren(el) //儿子生成\n  let code = `_c('${el.tag}',${el.attrs.length ? `${genProps(el.attrs)}` : \"undefined\"}${children ? `,${children}` : ''})`\n  return code\n}\n\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配标签名字  //ps:里面的\\\\ 是在字符串定义正则的时候需要转义\n//  ?: 匹配不捕获\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;  // <my:xx>  \nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\n\nexport function parseHTML(html) {\n  function createASTElement(tagName, attrs) {\n    return {\n      tag: tagName, //标签名\n      type: 1, // 元素类型\n      children: [], //子列表\n      attrs, //属性\n      parent: null //父节点\n    }\n\n  }\n  let root,\n    currentParent,\n    stack = []\n\n  //标签是否符合预期\n  function start(tagName, attrs) {\n    let element = createASTElement(tagName, attrs)\n    if (!root) {\n      root = element\n    }\n    currentParent = element // 当前解析的标签 保存起来\n    stack.push(element) //将生成的AST元素放到栈里面\n    // console.log(tagName, attrs, '---开始标签---');\n  }\n  function end(tagName) { //在结尾标签处,保存父子关系\n    let element = stack.pop()\n    // console.log(tagName, '---结束标签---');\n    currentParent = stack[stack.length - 1] // 因为出栈了 所以当前标签是之前的一个标签\n    if (currentParent) { // 当闭合的时候可以知道这个标签的父节点是谁\n      element.parent = currentParent\n      currentParent.children.push(element)\n    }\n  }\n\n  function chars(text) {\n    text = text.replace(/\\s/g, '') //去除空行\n    if (text) {\n      currentParent.children.push({\n        type: 3,\n        text\n      })\n    }\n    // console.log(text, '---文本---');\n  }\n\n\n  while (html) { //只要html不为空 则一直解析\n    let textEnd = html.indexOf('<')\n    if (textEnd == 0) {\n      //是标签\n      const startTagMatch = parseStartTag() //<xxx>开始标签匹配的结果\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n      const endTagMatch = html.match(endTag) //</ xxx>结束标签匹配\n      if (endTagMatch) {\n        advance(endTagMatch[0].length)\n        end(endTagMatch[1]) //将结束标签传入\n        continue\n      }\n    }\n    let text\n    if (textEnd > 0) { //是文本\n      text = html.substring(0, textEnd)\n    }\n\n    if (text) {\n      advance(text.length)\n      chars(text)\n    }\n    // break\n\n  }\n  //匹配到之后将html更新\n  function advance(n) {\n    html = html.substring(n)\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen)\n    // console.log(start);\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n      advance(start[0].length) //删除开始标签\n      //如果直接是闭合标签 说明没有属性\n      let end, attr\n      //不是结尾标签,并且能匹配到属性\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n        match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\n        advance(attr[0].length)\n        continue;\n      }\n      //去除 结尾的>\n      if (end) {\n        // debugger\n        advance(end[0].length)\n      }\n      // console.log('match', match);\n      return match\n    }\n  }\n  return root\n}","import { generate } from './generate';\nimport { parseHTML } from './parse'\n\n\nexport function compileToFunctions(template) {\n  //html模板 => render函数\n  //1.将html代码转换成AST语法树(可以用AST数去描述语言本身) \n  //ps:虚拟dom(虚拟dom是用对象来描述节点的)\n  let ast = parseHTML(template)\n  console.log(ast);\n  //2.优化静态节点\n\n  // 3.通过这颗树  重新生成代码\n  let code = generate(ast)\n  console.log(code);\n  //4.将字符串转换成render函数  限制取值范围 通过with来进行取值  稍后我们调用render函数就可以通过改变this 让这个函数内部取到成果了\n  let render = new Function(`with(this){return ${code}}`)\n  console.log(render);\n  return render\n}\n\n","export function patch(oldVnode, vnode) {\n  //将虚拟节点转换成真实节点\n  console.log(oldVnode, vnode);\n  let el = createElm(vnode) //产生真实的dom\n  let parentElm = oldVnode.parentNode //获取老的app的父亲 => body\n  parentElm.insertBefore(el, oldVnode.nextSibling)  //当前的真实元素插入到app的后面\n  parentElm.removeChild((oldVnode)) //删除老的节点\n}\n\nfunction createElm(vnode) {\n  let { tag, children, key, data, text } = vnode\n  if (typeof tag === 'string') { //创建元素 放到vnode.el上\n    vnode.el = document.createElement(tag)\n    children.forEach(child => {  //遍历儿子  将儿子渲染后的结果扔到父亲中\n      vnode.el.appendChild(createElm(child))\n    })\n  } else { // 创建文本 放到vnode.el上\n    vnode.el = document.createTextNode(text)\n  }\n  return vnode.el\n}\n\n// vue渲染流程 -> 先初始化数据 -> 将魔棒进行编译 => render函数 -> 生成虚拟节点 -> 生成真实节点 -> 扔到dom上去","import { patch } from \"./vdom/patch\";\n\nexport function lifecycleMixin(Vue) {\n  Vue.prototype._update = function (vnode) {\n    console.log(vnode, '--------vnode-');\n    const vm = this\n    patch(vm.$el, vnode)\n  }\n}\n\nexport function mountComponent(vm, el) {\n  // 调用render方法去渲染el属性\n\n  //先调用render方法创建虚拟节点 render ,再将虚拟节点渲染到页面上 update\n  vm._update(vm._render())\n}","// 切片编程\n\n\nlet oldArrayProtoMethods = Array.prototype;\n\n//继承一下\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\n\nlet methods = [\n  'push',\n  'pop',\n  'unshift',\n  'shift',\n  'reverse',\n  'splice',\n  'sort'\n]\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {  //这里的this就是observer的data\n    console.log('数组方法被调用了');\n    const result = oldArrayProtoMethods[method].apply(this, arguments)\n    let inserted\n    let ob = this.__ob__\n    switch (method) {\n      case 'push':\n      case 'unshift': //这两个内容都是添加,添加的内容可能是对象类型,应该再次进行劫持\n        inserted = args\n        break;\n      case 'splice': //vue.$set原理\n        inserted = args.slice(2) // 第3个就是新增的数据\n      default:\n        break;\n    }\n    //如果当前的inserted有值 则继续检测\n    if (inserted) ob.serveArray(inserted)\n    return result\n  }\n})\n\n\n\n","import { arrayMethods } from './array'\nclass Observer {\n  constructor(data) {\n    //使用defineProperty重新定义属性\n    //判断一个对象是否被观察到,则看这个属性有没有__ob__属性\n    Object.defineProperty(data, '__ob__', {\n      enumerable: false, //不能被枚举,不能被循环出来\n      configurable: false, // 不能修改赋值\n      value: this\n    })\n    if (Array.isArray(data)) {\n      Object.setPrototypeOf(data, arrayMethods)\n      //观测数组中的对象类型,对象变化也需要做一些事\n      this.observeArray(data)\n    } else {\n      //使用defineProperty 重新定义属性\n      this.walk(data)\n    }\n  }\n  observeArray(data) {\n    data.forEach(item => {\n      observe(item)\n    })\n  }\n  walk(data) {\n    let keys = Object.keys(data)\n    keys.forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value) // 递归下去\n  Object.defineProperty(data, key, {\n    get() {\n      console.log('获取值');\n      return value\n    },\n    set(newValue) {\n      console.log('设置值');\n      if (newValue === value) return\n      observe(newValue)  //如果用户设置的值还是一个对象,继续观测\n      value = newValue\n    }\n  })\n\n}\n\nexport function observe(data) {\n  // Object.defineProperty实际上也是可以对数组进行监控的，但是由于监控数组会去递归数组，会造成性能问题，所以改用数组原型重写的方法\n\n\n  // 如果不是对象直接return\n  if (typeof data !== 'object' || data === null) return\n  //如果已经被监听,则return\n  if (data.__ob__) return\n  return new Observer(data)\n}","export function proxy(vm, data, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[data][key]\n    },\n    set(newValue) {\n      vm[data][key] = newValue\n    }\n  })\n}","\nimport { observe } from './observer/index'\nimport { proxy } from './util'\nexport function initState(vm) {\n  const options = vm.$options;\n  if (options.props) {\n    initProps(vm)\n  }\n  if (options.methods) {\n    initMethods(vm)\n  }\n  if (options.data) {\n    initData(vm)\n  }\n  if (options.computed) {\n    initComputed(vm)\n  }\n  if (options.watch) {\n    initWatch(vm)\n  }\n}\n\nfunction initProps() {\n\n}\n\nfunction initMethods() {\n\n}\n\n\nfunction initData(vm) {\n  let data = vm.$options.data\n  // 判断data是否是函数,兼容函数或者对象\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data\n  //数据的劫持方案  对象Object.defineProperty\n  //数组 单独处理的\n\n  //当我从vm上取属性时,帮我吧属性上的取值代理到vm._data上\n  for (const key in data) {\n    if (Object.hasOwnProperty.call(data, key)) {\n      proxy(vm, \"_data\", key)\n    }\n  }\n\n  observe(data)\n}\n\nfunction initComputed() {\n\n}\n\nfunction initWatch() {\n\n}","import { compileToFunctions } from './compiler/index';\nimport { mountComponent } from './lifecycle.js';\nimport { initState } from './state'\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n\n    //初始化状态\n    initState(vm)\n\n    //初始化事件...\n\n    //如果有el属性 则表示需要渲染模板\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n  Vue.prototype.$mount = function (el) {\n    //挂载操作\n    const vm = this\n    const options = vm.$options\n    el = document.querySelector(el)\n    vm.$el = el\n    if (!options.render) {\n      //没有render方法,则将template转换成render方法\n      let template = options.template\n      if (!template && el) {\n        template = el.outerHTML\n      }\n      // 将模板编译成render函数\n      const render = compileToFunctions(template)\n      options.render = render\n    }\n    //需要挂载这个组件\n    mountComponent(vm, el)\n\n  }\n}","export function renderMixin(Vue) {\n  Vue.prototype._c = function () { //创建虚拟dom元素\n    return createElement(...arguments)\n  }\n  Vue.prototype._s = function (val) { // stringify\n    return val == null ? '' : (typeof val === 'object') ? JSON.stringify(val) : val\n  }\n  Vue.prototype._v = function (text) { //创建虚拟dom文本元素\n    return createTextVnode(text)\n  }\n  Vue.prototype._render = function () { // _render = render\n    const vm = this;\n    const render = vm.$options.render\n    let vnode = render.call(vm)\n    console.log(vnode);\n    return vnode\n  }\n}\n\nfunction createElement(tag, data = {}, ...children) {\n  return vnode(tag, data, data.key, children)\n  console.log(arguments);\n}\nfunction createTextVnode(text) {\n  return vnode(undefined, undefined, undefined, undefined, text)\n\n  console.log(text);\n}\n\n//用来产生虚拟dom的\nfunction vnode(tag, data, key, children, text) {\n  return {\n    tag,\n    data,\n    key,\n    children,\n    text,\n    // componentsInstances:\n  }\n}","import { initMixin } from './init'\nimport { lifecycleMixin } from './lifecycle'\nimport { renderMixin } from './vdom/index'\nfunction Vue(options) {\n  this._init(options) // 初始化操作\n}\n\n//Vue初始化方法\ninitMixin(Vue)\n\n//混合生命周期\nlifecycleMixin(Vue)\n\n//渲染\nrenderMixin(Vue)\nexport default Vue"],"names":["defaultTagRE","genProps","attrs","str","i","attr","name","obj","value","split","forEach","item","key","JSON","stringify","length","slice","gen","node","type","generate","text","test","tokens","lastIndex","match","index","exec","push","trim","join","getChildren","el","children","map","child","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tagName","parent","root","currentParent","stack","start","element","end","pop","chars","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","advance","substring","n","compileToFunctions","template","ast","console","log","render","Function","patch","oldVnode","vnode","createElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","data","document","createElement","appendChild","createTextNode","lifecycleMixin","Vue","prototype","_update","vm","$el","mountComponent","_render","oldArrayProtoMethods","Array","arrayMethods","Object","create","methods","method","args","result","apply","arguments","inserted","ob","__ob__","serveArray","Observer","defineProperty","enumerable","configurable","isArray","setPrototypeOf","observeArray","walk","observe","keys","defineReactive","get","set","newValue","proxy","initState","options","$options","props","initData","computed","watch","_data","call","hasOwnProperty","initMixin","_init","$mount","querySelector","outerHTML","renderMixin","_c","_s","val","_v","createTextVnode","undefined"],"mappings":"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"}